---
title: MCP Servers
description: Bundle tools into reusable Model Context Protocol servers
---

# MCP Servers

MCP (Model Context Protocol) servers let you bundle multiple related tools into a single, reusable unit. They're perfect for organizing tools by domain (e.g., file operations, database queries, API integrations).

## Creating MCP Servers

### Using McpServerBuilder

```typescript
import { McpServerBuilder, textResult, errorResult } from '@chucky.cloud/sdk';

const fileServer = new McpServerBuilder('file-tools', '1.0.0')
  .addTool({
    name: 'read_file',
    description: 'Read contents of a file',
    inputSchema: {
      type: 'object',
      properties: {
        path: { type: 'string', description: 'File path' },
      },
      required: ['path'],
    },
    handler: async ({ path }) => {
      const content = await fs.readFile(path, 'utf-8');
      return textResult(content);
    },
  })
  .addTool({
    name: 'write_file',
    description: 'Write content to a file',
    inputSchema: {
      type: 'object',
      properties: {
        path: { type: 'string' },
        content: { type: 'string' },
      },
      required: ['path', 'content'],
    },
    handler: async ({ path, content }) => {
      await fs.writeFile(path, content);
      return textResult(`Wrote ${content.length} bytes to ${path}`);
    },
  })
  .addTool({
    name: 'list_files',
    description: 'List files in a directory',
    inputSchema: {
      type: 'object',
      properties: {
        path: { type: 'string', description: 'Directory path' },
      },
      required: ['path'],
    },
    handler: async ({ path }) => {
      const files = await fs.readdir(path);
      return textResult(files.join('\n'));
    },
  })
  .build();
```

### Using createMcpServer

```typescript
import { createMcpServer, tool } from '@chucky.cloud/sdk';

const readTool = tool('read_file', 'Read a file', { ... }, handler);
const writeTool = tool('write_file', 'Write a file', { ... }, handler);
const listTool = tool('list_files', 'List files', { ... }, handler);

const fileServer = createMcpServer('file-tools', [
  readTool,
  writeTool,
  listTool,
], '1.0.0');
```

### Using mcpServer Helper

```typescript
import { mcpServer, textResult } from '@chucky.cloud/sdk';

const mathServer = mcpServer('math-tools')
  .addTool({
    name: 'add',
    description: 'Add two numbers',
    inputSchema: { ... },
    handler: async ({ a, b }) => textResult(String(a + b)),
  })
  .addTool({
    name: 'multiply',
    description: 'Multiply two numbers',
    inputSchema: { ... },
    handler: async ({ a, b }) => textResult(String(a * b)),
  })
  .build();
```

### Python MCP Servers

```python
from chucky import create_mcp_server, tool, text_result

@tool('read_file', 'Read contents of a file')
async def read_file(path: str) -> ToolResult:
    with open(path) as f:
        return text_result(f.read())

@tool('write_file', 'Write content to a file')
async def write_file(path: str, content: str) -> ToolResult:
    with open(path, 'w') as f:
        f.write(content)
    return text_result(f'Wrote {len(content)} bytes')

file_server = create_mcp_server('file-tools', [read_file, write_file])
```

## Using MCP Servers

### In Sessions

```typescript
const session = await client.createSession({
  model: 'claude-sonnet-4-5-20250929',
  mcpServers: [fileServer, mathServer],
});

await session.send('Read the config.json file and calculate 15% of the "budget" value');
```

### Multiple Servers

```typescript
const session = await client.createSession({
  mcpServers: [
    fileServer,      // File operations
    databaseServer,  // Database queries
    apiServer,       // External API calls
  ],
});
```

### Combining with Individual Tools

```typescript
const session = await client.createSession({
  tools: [customTool],           // Individual tools
  mcpServers: [fileServer],      // MCP server tools
});
```

## MCP Server Structure

```typescript
interface McpServer {
  name: string;           // Unique identifier
  version: string;        // Semantic version
  tools: ToolDefinition[];  // Array of tools
}
```

## Example: Database MCP Server

```typescript
import { McpServerBuilder, textResult, errorResult } from '@chucky.cloud/sdk';
import { db } from './database';

const databaseServer = new McpServerBuilder('database', '1.0.0')
  .addTool({
    name: 'query',
    description: 'Execute a read-only SQL query',
    inputSchema: {
      type: 'object',
      properties: {
        sql: {
          type: 'string',
          description: 'SQL SELECT query',
        },
        params: {
          type: 'array',
          items: { type: 'string' },
          description: 'Query parameters',
        },
      },
      required: ['sql'],
    },
    handler: async ({ sql, params = [] }) => {
      // Safety check
      if (!sql.trim().toLowerCase().startsWith('select')) {
        return errorResult('Only SELECT queries are allowed');
      }

      try {
        const results = await db.query(sql, params);
        return textResult(JSON.stringify(results, null, 2));
      } catch (err) {
        return errorResult(`Query error: ${err.message}`);
      }
    },
  })
  .addTool({
    name: 'get_schema',
    description: 'Get the schema of a table',
    inputSchema: {
      type: 'object',
      properties: {
        table: { type: 'string', description: 'Table name' },
      },
      required: ['table'],
    },
    handler: async ({ table }) => {
      const schema = await db.getTableSchema(table);
      return textResult(JSON.stringify(schema, null, 2));
    },
  })
  .addTool({
    name: 'list_tables',
    description: 'List all tables in the database',
    inputSchema: { type: 'object', properties: {} },
    handler: async () => {
      const tables = await db.listTables();
      return textResult(tables.join('\n'));
    },
  })
  .build();
```

## Example: API Integration Server

```typescript
const githubServer = new McpServerBuilder('github', '1.0.0')
  .addTool({
    name: 'get_repo',
    description: 'Get information about a GitHub repository',
    inputSchema: {
      type: 'object',
      properties: {
        owner: { type: 'string' },
        repo: { type: 'string' },
      },
      required: ['owner', 'repo'],
    },
    handler: async ({ owner, repo }) => {
      const response = await fetch(
        `https://api.github.com/repos/${owner}/${repo}`,
        { headers: { Authorization: `token ${GITHUB_TOKEN}` } }
      );
      const data = await response.json();
      return textResult(JSON.stringify(data, null, 2));
    },
  })
  .addTool({
    name: 'list_issues',
    description: 'List open issues for a repository',
    inputSchema: {
      type: 'object',
      properties: {
        owner: { type: 'string' },
        repo: { type: 'string' },
        state: { type: 'string', enum: ['open', 'closed', 'all'] },
      },
      required: ['owner', 'repo'],
    },
    handler: async ({ owner, repo, state = 'open' }) => {
      const response = await fetch(
        `https://api.github.com/repos/${owner}/${repo}/issues?state=${state}`,
        { headers: { Authorization: `token ${GITHUB_TOKEN}` } }
      );
      const issues = await response.json();
      return textResult(JSON.stringify(issues, null, 2));
    },
  })
  .build();
```

## Best Practices

<AccordionGroup>
  <Accordion title="Group related tools">
    Keep tools in the same MCP server if they share a common domain or data source:

    - `file-tools`: read, write, list, delete files
    - `database`: query, schema, tables
    - `github`: repos, issues, PRs
  </Accordion>

  <Accordion title="Version your servers">
    Use semantic versioning to track changes:

    ```typescript
    new McpServerBuilder('my-server', '2.1.0')
    ```
  </Accordion>

  <Accordion title="Consistent naming">
    Use consistent naming conventions across tools in a server:

    ```typescript
    // Good: verb_noun pattern
    'get_user', 'create_user', 'update_user', 'delete_user'

    // Bad: inconsistent
    'user_get', 'createUser', 'UserUpdate', 'remove'
    ```
  </Accordion>

  <Accordion title="Share state carefully">
    If tools in a server share state, ensure thread safety:

    ```typescript
    const server = new McpServerBuilder('cache', '1.0.0');
    const cache = new Map();

    server.addTool({
      name: 'cache_get',
      handler: async ({ key }) => textResult(cache.get(key) ?? 'null'),
    });

    server.addTool({
      name: 'cache_set',
      handler: async ({ key, value }) => {
        cache.set(key, value);
        return textResult('OK');
      },
    });
    ```
  </Accordion>
</AccordionGroup>
